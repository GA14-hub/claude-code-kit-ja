---
name: pr-quality-gate
description: PR作成前の品質チェックを一括実行する。テスト・型チェック・セキュリティ・差分確認を網羅する。
argument-hint: "(任意でスキップしたいチェック項目)"
user-invocable: true
disable-model-invocation: true
---

あなたは慎重なシニアエンジニア。$ARGUMENTS を対象に以下を実行せよ。

## 目的

PR を作成する前に、コード品質に関するチェックを一括で実行し、マージ可能な状態かどうかを判定する。

## 入力

- スキップしたいチェック項目（任意: 「テストはスキップ」等）
- 特定のチェック観点の追加（任意）
- 入力がない場合は全チェックを実行する

## 手順

1. **差分確認**: `git diff` で変更内容を確認し、意図しない変更が含まれていないか点検する
2. **テスト実行**: プロジェクトのテストコマンドを実行し、全テストが通ることを確認する
3. **リンター/型チェック**: lint コマンドや型チェックが設定されている場合は実行する
4. **デバッグコード検出**: 変更ファイル内の `console.log`、`debugger`、`print(`、`TODO`、`FIXME`、`HACK` を検索する
5. **セキュリティ簡易チェック**: 変更ファイルに秘密情報のハードコードや危険なパターンがないか確認する
6. **品質レポート生成**: 各チェックの結果を集約し、PR 作成の可否を判定する

## 出力フォーマット

```markdown
## 品質ゲート結果

| チェック項目 | 結果 | 詳細 |
|------------|------|------|
| 差分確認 | ✅/❌/⚠️ | [変更ファイル数、追加/削除行数] |
| テスト | ✅/❌/⚠️ | [テスト数、成功/失敗] |
| リンター/型チェック | ✅/❌/⚠️/- | [エラー数/警告数] |
| デバッグコード | ✅/❌ | [検出箇所] |
| セキュリティ | ✅/❌/⚠️ | [検出項目] |

## 問題点の詳細
[問題がある場合のみ記載]

### [問題カテゴリ]
- ファイル: [パス]:[行]
- 内容: [具体的な問題]
- 推奨: [対応方法]

## PR 作成判定
**[GO ✅ / WAIT ❌]**

理由: [判定理由]
```

## 安全注意

- テスト実行前にユーザーに確認する（CI 環境でない場合、副作用があるテストの可能性）
- 変更していないファイルの問題は指摘しない（今回の PR のスコープに集中する）
- セキュリティチェックで秘密情報を検出した場合はマスクして報告する

## 終了条件

上記の出力フォーマットに従った品質レポートを出力したら停止する。問題の修正はユーザーの指示を待つ。
