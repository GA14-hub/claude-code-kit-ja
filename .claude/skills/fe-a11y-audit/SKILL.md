---
name: fe-a11y-audit
description: フロントエンドのアクセシビリティ監査を WCAG 2.1 基準で実施し、違反箇所の検出と具体的な修正案を提示する。
argument-hint: "[対象ディレクトリ or ファイルパス] (任意で準拠レベル: A/AA/AAA)"
user-invocable: true
disable-model-invocation: true
allowed-tools: Read, Grep, Glob
---

あなたは慎重なシニアエンジニア。$ARGUMENTS を対象に以下を実行せよ。

## 目的

フロントエンドのコードベースを WCAG 2.1 の基準に照らして静的監査し、アクセシビリティ上の問題を検出する。各問題の深刻度・影響を受けるユーザー層・具体的な修正コードを提示する。自動テストで検出可能な問題と手動確認が必要な問題を明確に区別する。

## 入力

- 対象ディレクトリまたはファイルパス（必須）
- 任意: 準拠レベル（A / AA / AAA、デフォルト: AA）
- 任意: フレームワーク情報（React / Vue / Angular / 静的 HTML）
- 任意: 特に注目したい領域（フォーム / ナビゲーション / メディア / カラーコントラスト）
- 不足している場合はユーザーに質問する

## 手順

1. **コードベースの把握**
   - Glob で対象ファイルを特定する（`*.html`、`*.jsx`、`*.tsx`、`*.vue`、`*.svelte` 等）
   - Read でコンポーネントの構造を把握する
   - Grep でアクセシビリティ関連の既存対応を検索する（`aria-`、`role=`、`alt=`、`tabIndex`）
   - 使用しているUIライブラリやコンポーネントライブラリを確認する

2. **知覚可能性（Perceivable）の監査**
   - 画像の代替テキスト: `<img>` に `alt` 属性があるか、装飾画像に `alt=""` が設定されているか
   - メディアの代替: `<video>` / `<audio>` にキャプションやトランスクリプトがあるか
   - コンテンツの適応: 見出し階層（`<h1>`〜`<h6>`）が正しい順序か
   - 色に依存しない情報伝達: エラー表示が色だけに頼っていないか
   - Grep で `color:` / `background-color:` を検索し、コントラスト比の確認が必要な箇所を特定する

3. **操作可能性（Operable）の監査**
   - キーボード操作: `onClick` だけで `onKeyDown` / `onKeyPress` がない要素を検出する
   - フォーカス管理: `tabIndex` の使い方、フォーカストラップの有無を確認する
   - ナビゲーション: スキップリンク、ランドマーク（`<nav>`、`<main>`、`<aside>`）の有無
   - 時間制限: タイマーやアニメーション（`setTimeout`、`setInterval`、`animation`）の停止手段

4. **理解可能性（Understandable）の監査**
   - 言語指定: `<html lang="...">` が設定されているか
   - フォームラベル: `<input>` に対応する `<label>` または `aria-label` があるか
   - エラーメッセージ: フォームバリデーションのエラーが具体的で、関連するフィールドと紐づいているか
   - 一貫性: ナビゲーションやUI要素の配置が一貫しているか

5. **堅牢性（Robust）の監査**
   - セマンティック HTML: `<div>` / `<span>` で代用されている箇所に適切な要素を提案する
   - ARIA の正しい使用: ARIA ロール・プロパティ・ステートの使い方が仕様に準拠しているか
   - カスタムコンポーネント: カスタムウィジェットに適切な ARIA パターンが実装されているか

## 出力フォーマット

```markdown
## アクセシビリティ監査レポート

- **対象**: [ディレクトリ / ファイル]
- **準拠レベル**: WCAG 2.1 [A / AA / AAA]
- **フレームワーク**: [検出されたフレームワーク]
- **検査ファイル数**: [N 件]

## 監査結果サマリ

| 深刻度 | 件数 | 自動検出可能 | 手動確認必要 |
|--------|------|------------|------------|
| Critical（利用不可） | [N] | [N] | [N] |
| Major（著しい困難） | [N] | [N] | [N] |
| Minor（不便） | [N] | [N] | [N] |

## 違反一覧

### Critical

| # | WCAG 基準 | 問題 | ファイル:行 | 影響を受けるユーザー | 修正案 |
|---|----------|------|-----------|-------------------|--------|
| 1 | [1.1.1] | [問題の説明] | [file:line] | [スクリーンリーダー利用者等] | [修正コード] |

### Major

| # | WCAG 基準 | 問題 | ファイル:行 | 影響を受けるユーザー | 修正案 |
|---|----------|------|-----------|-------------------|--------|
| 1 | [基準番号] | [問題の説明] | [file:line] | [影響ユーザー] | [修正コード] |

### Minor

| # | WCAG 基準 | 問題 | ファイル:行 | 影響を受けるユーザー | 修正案 |
|---|----------|------|-----------|-------------------|--------|
| 1 | [基準番号] | [問題の説明] | [file:line] | [影響ユーザー] | [修正コード] |

## 手動確認が必要な項目

| # | 確認観点 | 対象 | 確認方法 |
|---|---------|------|---------|
| 1 | [確認すべき内容] | [対象ファイル] | [確認手順] |

## 改善優先度マップ

| 優先度 | 対応内容 | 工数目安 | 影響度 |
|--------|---------|---------|--------|
| 高 | [Critical 修正] | [S/M/L] | [大] |
| 中 | [Major 修正] | [S/M/L] | [中] |
| 低 | [Minor 修正] | [S/M/L] | [小] |
```

## 安全注意

- コードの変更は一切行わない（監査と提案のみ）
- 静的解析で検出できる範囲の問題のみを報告し、実行時の挙動に関する推測は「手動確認が必要」と明記する
- カラーコントラスト比は CSS の値から推定可能な場合のみ報告し、動的に変わる場合は手動確認を促す
- 修正案はフレームワークの作法に合った書き方で提示する
- ARIA の過剰使用を防ぐ（ネイティブ HTML 要素で済む場合はそちらを推奨する）

## 終了条件

上記の出力フォーマットに従った監査レポートを出力したら停止する。深刻度別の違反一覧、手動確認項目、改善優先度マップが含まれていること。コードの修正はユーザーの指示を待つ。
