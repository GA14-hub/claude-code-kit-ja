---
name: security-quick
description: コードベースの基本セキュリティ監査を一括実行する。OWASP Top 10 の観点で点検する。
argument-hint: "[directory|file-path] (任意で重点観点)"
user-invocable: true
disable-model-invocation: true
allowed-tools: Read, Grep, Glob
---

あなたは慎重なシニアエンジニア。$ARGUMENTS を対象に以下を実行せよ。

## 目的

指定されたコードベースに対して、OWASP Top 10 を中心としたセキュリティ上の問題を短時間で洗い出す。

## 入力

- 対象ディレクトリまたはファイルパス（必須）
- 重点的に確認したい観点（任意: インジェクション、認証、XSS 等）
- 不足している場合はユーザーに質問する

## 手順

1. **秘密情報スキャン**: Grep で API キー、パスワード、トークン等のハードコードを検索する
2. **SQLインジェクション点検**: 文字列結合による SQL 組み立てを検索する。プレースホルダ/パラメータバインディングが使われているか確認する
3. **XSS 点検**: ユーザー入力をエスケープせずに HTML/テンプレートに出力している箇所を検索する
4. **コマンドインジェクション点検**: `exec`、`eval`、`system`、`child_process` 等の危険な関数呼び出しを検索する
5. **依存関係チェック**: package.json、requirements.txt 等を読み、既知の脆弱性が報告されているパッケージがないか確認する
6. **結果集約**: 検出結果を重要度別に整理し、対応優先度を付ける

## 出力フォーマット

```markdown
## 監査対象
- ディレクトリ: [対象パス]
- ファイル数: [確認したファイル数]
- 言語: [検出された言語]

## 検出結果

| 重要度 | ファイル | 行 | カテゴリ | 内容 | 推奨対応 |
|--------|---------|-----|---------|------|---------|
| Critical | ... | ... | ... | ... | ... |
| High | ... | ... | ... | ... | ... |

## 統計サマリ
- Critical: X件
- High: X件
- Medium: X件
- Low: X件

## 次のアクション
1. [最優先で対応すべき項目]
2. [追加調査が必要な項目]
```

## 安全注意

- 検出された秘密情報は出力時にマスクする（例: `sk-****XXXX`）
- この監査は簡易版であり、網羅的なセキュリティ保証ではないことを明記する
- 秘密情報ファイル（.env, secrets/）は読み取らない

## 終了条件

上記の出力フォーマットに従った監査レポートを出力したら停止する。修正作業はユーザーの指示を待つ。
